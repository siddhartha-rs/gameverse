<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Endless Traffic Racer</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      user-select: none;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(to bottom, #1a1a2e, #16213e);
      color: white;
      overflow: hidden;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .game-container {
      position: relative;
      width: 100%;
      max-width: 500px;
      height: 100vh;
      max-height: 700px;
      overflow: hidden;
    }

    /* Game screens */
    .screen {
      position: absolute;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      background: rgba(0, 0, 20, 0.85);
      transition: opacity 0.5s;
      z-index: 100;
      padding: 20px;
      text-align: center;
    }

    #game-screen {
      background: transparent;
      display: block;
      z-index: 1;
    }

    .hidden {
      opacity: 0;
      pointer-events: none;
    }

    h1 {
      font-size: 2.5rem;
      margin-bottom: 20px;
      color: #ffcc00;
      text-shadow: 0 0 10px rgba(255, 204, 0, 0.5);
    }

    h2 {
      font-size: 1.8rem;
      margin-bottom: 15px;
      color: #ffcc00;
    }

    p {
      margin-bottom: 15px;
      line-height: 1.5;
    }

    button {
      background: linear-gradient(to bottom, #ffcc00, #ff9900);
      color: #1a1a2e;
      border: none;
      padding: 12px 25px;
      font-size: 1.2rem;
      border-radius: 50px;
      margin: 10px;
      cursor: pointer;
      font-weight: bold;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
      transition: transform 0.2s, box-shadow 0.2s;
    }

    button:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.4);
    }

    button:active {
      transform: translateY(1px);
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.4);
    }

    /* Stats and controls */
    .stats {
      position: absolute;
      top: 10px;
      left: 0;
      width: 100%;
      display: flex;
      justify-content: space-between;
      padding: 10px 20px;
      z-index: 10;
    }

    .stat {
      background: rgba(0, 0, 0, 0.5);
      padding: 8px 15px;
      border-radius: 20px;
      display: flex;
      align-items: center;
    }

    .stat i {
      margin-right: 8px;
      color: #ffcc00;
    }

    /* Game elements */
    .road {
      position: absolute;
      width: 100%;
      height: 100%;
      background: linear-gradient(to bottom, #444, #222);
      overflow: hidden;
    }

    .lane {
      position: absolute;
      width: 25%;
      height: 100%;
      border-left: 2px dashed yellow;
      border-right: 2px dashed yellow;
    }

    .lane:nth-child(1) {
      left: 0;
    }

    .lane:nth-child(2) {
      left: 25%;
    }

    .lane:nth-child(3) {
      left: 50%;
    }

    .lane:nth-child(4) {
      left: 75%;
      border-right: none;
    }

    /* Cars */
    .car {
      position: absolute;
      transition: left 0.2s ease;
      z-index: 2;
    }

    .player-car {
      bottom: 50px;
      left: 37.5%;
      width: 60px;
      height: 100px;
      background: linear-gradient(to bottom, #ff3300, #cc0000);
      border-radius: 10px 10px 5px 5px;
      box-shadow: 0 0 15px rgba(255, 0, 0, 0.5);
    }

    .player-car::before {
      content: '';
      position: absolute;
      top: 15px;
      left: 5px;
      width: 50px;
      height: 40px;
      background: linear-gradient(to bottom, #cc0000, #990000);
      border-radius: 5px;
    }

    .player-car::after {
      content: '';
      position: absolute;
      bottom: 10px;
      left: 5px;
      width: 20px;
      height: 30px;
      background: #333;
      border-radius: 3px;
    }

    .traffic-car {
      width: 60px;
      height: 100px;
      border-radius: 10px 10px 5px 5px;
      box-shadow: 0 0 10px rgba(0, 0, 255, 0.5);
    }

    .traffic-car::before {
      content: '';
      position: absolute;
      top: 15px;
      left: 5px;
      width: 50px;
      height: 40px;
      border-radius: 5px;
    }

    .traffic-car::after {
      content: '';
      position: absolute;
      bottom: 10px;
      left: 5px;
      width: 20px;
      height: 30px;
      background: #333;
      border-radius: 3px;
    }

    /* Car colors */
    .car-blue {
      background: linear-gradient(to bottom, #0066cc, #004499);
    }

    .car-blue::before {
      background: linear-gradient(to bottom, #004499, #002266);
    }

    .car-green {
      background: linear-gradient(to bottom, #00cc66, #00994c);
    }

    .car-green::before {
      background: linear-gradient(to bottom, #00994c, #006633);
    }

    .car-yellow {
      background: linear-gradient(to bottom, #ffcc00, #cc9900);
    }

    .car-yellow::before {
      background: linear-gradient(to bottom, #cc9900, #996600);
    }

    /* Side objects */
    .side-object {
      position: absolute;
      width: 30px;
      height: 50px;
      background: #333;
      z-index: 1;
    }

    .tree {
      width: 40px;
      height: 80px;
      background: #663300;
      border-radius: 5px;
    }

    .tree::after {
      content: '';
      position: absolute;
      top: -30px;
      left: -20px;
      width: 80px;
      height: 60px;
      background: #006633;
      border-radius: 50%;
    }

    /* Mobile controls */
    .mobile-controls {
      position: absolute;
      bottom: 20px;
      width: 100%;
      display: flex;
      justify-content: space-around;
      padding: 0 20px;
      z-index: 10;
    }

    .control-btn {
      width: 70px;
      height: 70px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.2);
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 30px;
      color: white;
      backdrop-filter: blur(5px);
      border: 2px solid rgba(255, 255, 255, 0.3);
    }

    /* Game over effects */
    .crash-effect {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255, 0, 0, 0.3);
      pointer-events: none;
      opacity: 0;
      z-index: 20;
    }

    /* Sound controls */
    .sound-control {
      position: absolute;
      top: 20px;
      right: 20px;
      z-index: 11;
      background: rgba(0, 0, 0, 0.5);
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      color: white;
      font-size: 20px;
    }

    /* Instructions */
    .instructions {
      background: rgba(0, 0, 0, 0.7);
      padding: 20px;
      border-radius: 10px;
      max-width: 400px;
      margin: 20px 0;
    }

    .instruction-item {
      margin: 10px 0;
      display: flex;
      align-items: center;
    }

    .instruction-item i {
      margin-right: 10px;
      color: #ffcc00;
      font-size: 1.2rem;
    }

    /* Animation for road movement */
    @keyframes roadScroll {
      from {
        background-position: 0 0;
      }

      to {
        background-position: 0 100vh;
      }
    }

    .road::before {
      content: '';
      position: absolute;
      width: 100%;
      height: 200%;
      background: repeating-linear-gradient(to bottom,
          transparent 0,
          transparent 20px,
          rgba(255, 255, 255, 0.2) 20px,
          rgba(255, 255, 255, 0.2) 40px);
      animation: roadScroll 1s linear infinite;
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
      h1 {
        font-size: 2rem;
      }

      .stats {
        padding: 5px 10px;
      }

      .stat {
        font-size: 0.9rem;
        padding: 5px 10px;
      }

      .player-car,
      .traffic-car {
        width: 50px;
        height: 80px;
      }

      .player-car::before,
      .traffic-car::before {
        width: 40px;
        height: 30px;
      }
    }

    @media (min-width: 769px) {
      .mobile-controls {
        display: none;
      }
    }
  </style>
</head>

<body>
  <div class="game-container">
    <!-- Start Screen -->
    <div id="start-screen" class="screen">
      <h1>Endless Traffic Racer</h1>
      <p>Dodge traffic and survive as long as possible!</p>
      <button id="start-btn">Start Game</button>
      <button id="how-to-play-btn">How to Play</button>

      <div class="sound-control" id="sound-control">
        <i class="fas fa-volume-up"></i>
      </div>
    </div>

    <!-- How to Play Screen -->
    <div id="how-to-play-screen" class="screen hidden">
      <h2>How to Play</h2>
      <div class="instructions">
        <div class="instruction-item">
          <i class="fas fa-desktop"></i>
          <span>Desktop: Use arrow keys to move</span>
        </div>
        <div class="instruction-item">
          <i class="fas fa-mobile-alt"></i>
          <span>Mobile: Use on-screen buttons</span>
        </div>
        <div class="instruction-item">
          <i class="fas fa-car"></i>
          <span>Avoid colliding with other cars</span>
        </div>
        <div class="instruction-item">
          <i class="fas fa-tachometer-alt"></i>
          <span>Speed increases over time</span>
        </div>
      </div>
      <button id="back-btn">Back to Menu</button>

      <div class="sound-control" id="sound-control-2">
        <i class="fas fa-volume-up"></i>
      </div>
    </div>

    <!-- Game Over Screen -->
    <div id="game-over-screen" class="screen hidden">
      <h2>Game Over</h2>
      <p>You crashed!</p>
      <p>Score: <span id="final-score">0</span></p>
      <p>High Score: <span id="high-score">0</span></p>
      <button id="restart-btn">Play Again</button>

      <div class="sound-control" id="sound-control-3">
        <i class="fas fa-volume-up"></i>
      </div>
    </div>

    <!-- Game Screen -->
    <div id="game-screen" class="screen hidden">
      <div class="stats">
        <div class="stat">
          <i class="fas fa-tachometer-alt"></i>
          <span id="speed">0 km/h</span>
        </div>
        <div class="stat">
          <i class="fas fa-road"></i>
          <span id="distance">0 m</span>
        </div>
        <div class="stat">
          <i class="fas fa-star"></i>
          <span id="score">0</span>
        </div>
      </div>

      <div class="road">
        <div class="lane"></div>
        <div class="lane"></div>
        <div class="lane"></div>
        <div class="lane"></div>

        <div class="player-car"></div>

        <!-- Traffic cars will be added dynamically -->
      </div>

      <div class="mobile-controls">
        <div class="control-btn" id="left-btn"><i class="fas fa-arrow-left"></i></div>
        <div class="control-btn" id="right-btn"><i class="fas fa-arrow-right"></i></div>
      </div>

      <div class="crash-effect" id="crash-effect"></div>

      <div class="sound-control" id="sound-control-4">
        <i class="fas fa-volume-up"></i>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      // Game elements
      const startScreen = document.getElementById('start-screen');
      const howToPlayScreen = document.getElementById('how-to-play-screen');
      const gameOverScreen = document.getElementById('game-over-screen');
      const gameScreen = document.getElementById('game-screen');
      const startBtn = document.getElementById('start-btn');
      const howToPlayBtn = document.getElementById('how-to-play-btn');
      const backBtn = document.getElementById('back-btn');
      const restartBtn = document.getElementById('restart-btn');
      const finalScore = document.getElementById('final-score');
      const highScoreEl = document.getElementById('high-score');
      const speedEl = document.getElementById('speed');
      const distanceEl = document.getElementById('distance');
      const scoreEl = document.getElementById('score');
      const playerCar = document.querySelector('.player-car');
      const road = document.querySelector('.road');
      const leftBtn = document.getElementById('left-btn');
      const rightBtn = document.getElementById('right-btn');
      const crashEffect = document.getElementById('crash-effect');
      const soundControls = document.querySelectorAll('.sound-control');

      // Game variables
      let gameActive = false;
      let playerLane = 2; // 1-4
      let speed = 60;
      let distance = 0;
      let score = 0;
      let highScore = localStorage.getItem('highScore') || 0;
      let trafficCars = [];
      let sideObjects = [];
      let gameLoop;
      let soundOn = true;
      let moveLeft = false;
      let moveRight = false;

      // Audio elements
      const engineSound = new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA');
      const crashSound = new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA');
      const backgroundMusic = new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA');

      // Set high score
      highScoreEl.textContent = highScore;

      // Event listeners for buttons
      startBtn.addEventListener('click', startGame);
      howToPlayBtn.addEventListener('click', showHowToPlay);
      backBtn.addEventListener('click', showStartScreen);
      restartBtn.addEventListener('click', startGame);

      // Keyboard controls
      document.addEventListener('keydown', function (e) {
        if (!gameActive) return;

        if (e.key === 'ArrowLeft' && playerLane > 1) {
          playerLane--;
          updatePlayerPosition();
        } else if (e.key === 'ArrowRight' && playerLane < 4) {
          playerLane++;
          updatePlayerPosition();
        }
      });

      // Mobile controls
      leftBtn.addEventListener('touchstart', function () {
        if (gameActive && playerLane > 1) {
          playerLane--;
          updatePlayerPosition();
        }
      });

      rightBtn.addEventListener('touchstart', function () {
        if (gameActive && playerLane < 4) {
          playerLane++;
          updatePlayerPosition();
        }
      });

      // Sound controls
      soundControls.forEach(control => {
        control.addEventListener('click', toggleSound);
      });

      // Function to start the game
      function startGame() {
        // Reset game state
        gameActive = true;
        speed = 60;
        distance = 0;
        score = 0;
        playerLane = 2;
        trafficCars = [];
        sideObjects = [];

        // Update UI
        speedEl.textContent = speed + ' km/h';
        distanceEl.textContent = distance + ' m';
        scoreEl.textContent = score;

        // Clear existing traffic cars
        document.querySelectorAll('.traffic-car').forEach(car => car.remove());
        document.querySelectorAll('.side-object').forEach(obj => obj.remove());

        // Show game screen, hide others
        startScreen.classList.add('hidden');
        howToPlayScreen.classList.add('hidden');
        gameOverScreen.classList.add('hidden');
        gameScreen.classList.remove('hidden');

        // Update player position
        updatePlayerPosition();

        // Start game loop
        if (gameLoop) clearInterval(gameLoop);
        gameLoop = setInterval(updateGame, 100);

        // Play sounds
        if (soundOn) {
          engineSound.loop = true;
          engineSound.play();
          backgroundMusic.loop = true;
          backgroundMusic.play();
        }
      }

      // Function to update game state
      function updateGame() {
        if (!gameActive) return;

        // Increase speed and distance
        speed += 0.1;
        distance += Math.floor(speed / 20);

        // Update score based on speed and distance
        score += Math.floor(speed / 10);

        // Update UI
        speedEl.textContent = Math.floor(speed) + ' km/h';
        distanceEl.textContent = distance + ' m';
        scoreEl.textContent = score;

        // Generate traffic
        if (Math.random() < 0.1) {
          generateTraffic();
        }

        // Generate side objects
        if (Math.random() < 0.05) {
          generateSideObject();
        }

        // Move traffic cars
        moveTraffic();

        // Move side objects
        moveSideObjects();

        // Check for collisions
        checkCollisions();
      }

      // Function to update player position
      function updatePlayerPosition() {
        playerCar.style.left = `${(playerLane - 1) * 25 + 12.5 - 7.5}%`;
      }

      // Function to generate traffic
      function generateTraffic() {
        const lane = Math.floor(Math.random() * 4) + 1;
        const carTypes = ['car-blue', 'car-green', 'car-yellow'];
        const carType = carTypes[Math.floor(Math.random() * carTypes.length)];

        const trafficCar = document.createElement('div');
        trafficCar.className = `traffic-car ${carType}`;
        trafficCar.style.left = `${(lane - 1) * 25 + 12.5 - 7.5}%`;
        trafficCar.style.top = '-100px';

        road.appendChild(trafficCar);

        trafficCars.push({
          element: trafficCar,
          lane: lane,
          speed: Math.random() * 2 + 3
        });
      }

      // Function to generate side objects
      function generateSideObject() {
        const side = Math.random() < 0.5 ? 'left' : 'right';
        const objectType = Math.random() < 0.5 ? 'tree' : 'light';

        const sideObject = document.createElement('div');
        sideObject.className = `side-object ${objectType}`;

        if (side === 'left') {
          sideObject.style.left = '5%';
        } else {
          sideObject.style.right = '5%';
        }

        sideObject.style.top = '-50px';

        road.appendChild(sideObject);

        sideObjects.push({
          element: sideObject,
          speed: Math.random() * 2 + 3
        });
      }

      // Function to move traffic
      function moveTraffic() {
        for (let i = trafficCars.length - 1; i >= 0; i--) {
          const car = trafficCars[i];
          const top = parseInt(car.element.style.top || 0) + car.speed;

          if (top > 800) {
            road.removeChild(car.element);
            trafficCars.splice(i, 1);
          } else {
            car.element.style.top = `${top}px`;
          }
        }
      }

      // Function to move side objects
      function moveSideObjects() {
        for (let i = sideObjects.length - 1; i >= 0; i--) {
          const obj = sideObjects[i];
          const top = parseInt(obj.element.style.top || 0) + obj.speed;

          if (top > 800) {
            road.removeChild(obj.element);
            sideObjects.splice(i, 1);
          } else {
            obj.element.style.top = `${top}px`;
          }
        }
      }

      // Function to check collisions
      function checkCollisions() {
        const playerRect = playerCar.getBoundingClientRect();

        for (const car of trafficCars) {
          const carRect = car.element.getBoundingClientRect();

          // Simple collision detection
          if (
            playerRect.left < carRect.right &&
            playerRect.right > carRect.left &&
            playerRect.top < carRect.bottom &&
            playerRect.bottom > carRect.top
          ) {
            gameOver();
            return;
          }
        }
      }

      // Function to handle game over
      function gameOver() {
        gameActive = false;
        clearInterval(gameLoop);

        // Update high score if needed
        if (score > highScore) {
          highScore = score;
          localStorage.setItem('highScore', highScore);
          highScoreEl.textContent = highScore;
        }

        // Show crash effect
        crashEffect.style.opacity = '1';
        setTimeout(() => {
          crashEffect.style.opacity = '0';
        }, 500);

        // Play crash sound
        if (soundOn) {
          engineSound.pause();
          crashSound.play();
          backgroundMusic.pause();
        }

        // Show game over screen after a delay
        setTimeout(() => {
          finalScore.textContent = score;
          gameScreen.classList.add('hidden');
          gameOverScreen.classList.remove('hidden');
        }, 1000);
      }

      // Function to show how to play screen
      function showHowToPlay() {
        startScreen.classList.add('hidden');
        howToPlayScreen.classList.remove('hidden');
      }

      // Function to show start screen
      function showStartScreen() {
        howToPlayScreen.classList.add('hidden');
        gameOverScreen.classList.add('hidden');
        startScreen.classList.remove('hidden');
      }

      // Function to toggle sound
      function toggleSound() {
        soundOn = !soundOn;

        const icon = this.querySelector('i');
        if (soundOn) {
          icon.className = 'fas fa-volume-up';
          engineSound.play();
          backgroundMusic.play();
        } else {
          icon.className = 'fas fa-volume-mute';
          engineSound.pause();
          backgroundMusic.pause();
        }

        // Update all sound controls
        document.querySelectorAll('.sound-control i').forEach(icon => {
          icon.className = soundOn ? 'fas fa-volume-up' : 'fas fa-volume-mute';
        });
      }

      // Initialize game with start screen
      showStartScreen();
    });
  </script>
</body>

</html>