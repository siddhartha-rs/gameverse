<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Minimal Aim Trainer</title>
  <style>
    /* Modern Minimalist Style */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      user-select: none;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background-color: #f8f9fa;
      color: #212529;
      overflow: hidden;
      touch-action: manipulation;
      height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    /* Game Container */
    #game-container {
      position: relative;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    /* Canvas */
    #game-canvas {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
    }

    /* UI Elements */
    #score-display {
      position: absolute;
      top: 30px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 1.5rem;
      font-weight: 600;
      color: #495057;
      z-index: 2;
      background: rgba(255, 255, 255, 0.9);
      padding: 8px 16px;
      border-radius: 20px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    /* Crosshair */
    #crosshair {
      position: absolute;
      width: 24px;
      height: 24px;
      pointer-events: none;
      z-index: 3;
      transform: translate(-50%, -50%);
      display: none;
    }

    #crosshair::before,
    #crosshair::after {
      content: '';
      position: absolute;
      background-color: rgba(33, 37, 41, 0.8);
    }

    #crosshair::before {
      width: 2px;
      height: 24px;
      left: 11px;
      top: 0;
    }

    #crosshair::after {
      width: 24px;
      height: 2px;
      left: 0;
      top: 11px;
    }

    /* Game Over Screen */
    #game-over {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(248, 249, 250, 0.95);
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 4;
      text-align: center;
    }

    #game-over h1 {
      color: #212529;
      font-size: 2.5rem;
      margin-bottom: 16px;
      font-weight: 700;
    }

    #final-score {
      font-size: 1.5rem;
      margin-bottom: 8px;
      color: #495057;
    }

    #reaction-time {
      font-size: 1.25rem;
      margin-bottom: 24px;
      color: #6c757d;
    }

    #restart-btn {
      padding: 12px 24px;
      font-size: 1rem;
      background: #212529;
      border: none;
      border-radius: 8px;
      color: white;
      cursor: pointer;
      outline: none;
      transition: all 0.2s;
      font-weight: 500;
    }

    #restart-btn:hover {
      background: #343a40;
      transform: translateY(-2px);
    }

    /* Countdown Screen */
    #countdown {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(248, 249, 250, 0.95);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 5;
      text-align: center;
    }

    #countdown-number {
      font-size: 5rem;
      font-weight: 700;
      color: #212529;
      margin-bottom: 24px;
    }

    #instructions {
      font-size: 1.25rem;
      color: #6c757d;
      max-width: 300px;
      margin-bottom: 40px;
      line-height: 1.5;
    }

    /* Target Styles */
    .target {
      position: absolute;
      border-radius: 50%;
      background: #212529;
      transform: translate(-50%, -50%);
      z-index: 2;
    }

    /* Responsive Adjustments */
    @media (orientation: portrait) {
      #crosshair {
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
      }
    }
  </style>
</head>

<body>
  <div id="game-container">
    <canvas id="game-canvas"></canvas>
    <div id="score-display">0</div>
    <div id="crosshair"></div>

    <div id="countdown">
      <div id="countdown-number">3</div>
      <div id="instructions">
        <strong>How to play:</strong><br>
        Desktop: Right-click the targets<br>
        Mobile: Tap the targets<br>
        Hit as many as you can!
      </div>
    </div>

    <div id="game-over">
      <h1>GAME OVER</h1>
      <div id="final-score">Score: 0</div>
      <div id="reaction-time">Average Reaction: 0ms</div>
      <button id="restart-btn">PLAY AGAIN</button>
    </div>
  </div>

  <script>
    // Game State
    const gameState = {
      score: 0,
      isPlaying: false,
      target: null,
      crosshair: { x: 0, y: 0 },
      startTime: 0,
      reactionTimes: [],
      difficulty: {
        baseSize: 80,
        minSize: 30,
        visibleTime: 1500,
        minVisibleTime: 600,
        speed: 0,
        maxSpeed: 4
      },
      isMobile: false,
      countdown: 3
    };

    // DOM Elements
    const canvas = document.getElementById('game-canvas');
    const ctx = canvas.getContext('2d');
    const scoreDisplay = document.getElementById('score-display');
    const crosshair = document.getElementById('crosshair');
    const gameOverScreen = document.getElementById('game-over');
    const finalScoreDisplay = document.getElementById('final-score');
    const reactionTimeDisplay = document.getElementById('reaction-time');
    const restartBtn = document.getElementById('restart-btn');
    const countdownScreen = document.getElementById('countdown');
    const countdownNumber = document.getElementById('countdown-number');

    // Initialize Game
    function initGame() {
      // Check if mobile
      gameState.isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

      // Setup canvas
      resizeCanvas();
      window.addEventListener('resize', resizeCanvas);

      // Setup crosshair
      if (gameState.isMobile) {
        crosshair.style.display = 'block';
        crosshair.style.left = '50%';
        crosshair.style.top = '50%';
        gameState.crosshair.x = window.innerWidth / 2;
        gameState.crosshair.y = window.innerHeight / 2;
      } else {
        document.addEventListener('mousemove', updateCrosshair);
        crosshair.style.display = 'block';
      }

      // Setup controls
      if (gameState.isMobile) {
        canvas.addEventListener('touchstart', handleTap);
      } else {
        canvas.addEventListener('contextmenu', handleRightClick);
        document.addEventListener('keydown', handleKeyPress);
      }

      // Setup restart button
      restartBtn.addEventListener('click', startCountdown);

      // Start countdown
      startCountdown();
    }

    // Start countdown
    function startCountdown() {
      gameState.score = 0;
      gameState.isPlaying = false;
      gameState.reactionTimes = [];
      gameState.countdown = 3;

      // Show countdown screen
      countdownScreen.style.display = 'flex';
      gameOverScreen.style.display = 'none';

      // Start countdown
      countdownNumber.textContent = gameState.countdown;
      const countdownInterval = setInterval(() => {
        gameState.countdown--;
        countdownNumber.textContent = gameState.countdown;

        if (gameState.countdown <= 0) {
          clearInterval(countdownInterval);
          countdownScreen.style.display = 'none';
          startGame();
        }
      }, 1000);
    }

    // Resize canvas to fit window
    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      if (gameState.isPlaying) {
        drawGame();
      }
    }

    // Update crosshair position
    function updateCrosshair(e) {
      gameState.crosshair.x = e.clientX;
      gameState.crosshair.y = e.clientY;
      crosshair.style.left = `${e.clientX}px`;
      crosshair.style.top = `${e.clientY}px`;
    }

    // Handle right click
    function handleRightClick(e) {
      e.preventDefault();
      checkHit(e.clientX, e.clientY);
    }

    // Handle tap (mobile)
    function handleTap(e) {
      e.preventDefault();
      const touch = e.touches[0] || e.changedTouches[0];
      checkHit(touch.clientX, touch.clientY);
    }

    // Handle space bar for accessibility
    function handleKeyPress(e) {
      if (e.code === 'Space') {
        checkHit(gameState.crosshair.x, gameState.crosshair.y);
      }
    }

    // Check if hit was successful
    function checkHit(x, y) {
      if (!gameState.isPlaying || !gameState.target) return;

      const distance = Math.sqrt(
        Math.pow(x - gameState.target.x, 2) +
        Math.pow(y - gameState.target.y, 2)
      );

      if (distance <= gameState.target.radius) {
        // Successful hit
        const reactionTime = Date.now() - gameState.startTime;
        gameState.reactionTimes.push(reactionTime);
        gameState.score++;
        scoreDisplay.textContent = gameState.score;
        spawnTarget();
      } else {
        // Missed
        gameOver();
      }
    }

    // Spawn a new target
    function spawnTarget() {
      // Calculate difficulty based on score
      const sizeReduction = Math.min(gameState.score * 1.5, gameState.difficulty.baseSize - gameState.difficulty.minSize);
      const timeReduction = Math.min(gameState.score * 40, gameState.difficulty.visibleTime - gameState.difficulty.minVisibleTime);
      const speedIncrease = Math.min(gameState.score * 0.08, gameState.difficulty.maxSpeed);

      const size = gameState.difficulty.baseSize - sizeReduction;
      const visibleTime = gameState.difficulty.visibleTime - timeReduction;

      // Random position (with padding from edges)
      const padding = size + 20;
      const x = padding + Math.random() * (canvas.width - padding * 2);
      const y = padding + Math.random() * (canvas.height - padding * 2);

      // Random direction for moving targets
      const angle = Math.random() * Math.PI * 2;
      const speed = speedIncrease > 0 ? speedIncrease : 0;

      gameState.target = {
        x, y,
        radius: size / 2,
        size,
        visibleTime,
        spawnTime: Date.now(),
        speed,
        angle,
        isMoving: speed > 0
      };

      gameState.startTime = Date.now();

      // Schedule target disappearance
      if (gameState.targetTimer) {
        clearTimeout(gameState.targetTimer);
      }
      gameState.targetTimer = setTimeout(() => {
        if (gameState.isPlaying) {
          gameOver();
        }
      }, visibleTime);
    }

    // Draw the game
    function drawGame() {
      // Clear canvas
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Draw target if exists
      if (gameState.target) {
        // Update position if moving
        if (gameState.target.isMoving) {
          gameState.target.x += Math.cos(gameState.target.angle) * gameState.target.speed;
          gameState.target.y += Math.sin(gameState.target.angle) * gameState.target.speed;

          // Bounce off edges
          if (gameState.target.x - gameState.target.radius < 0 ||
            gameState.target.x + gameState.target.radius > canvas.width) {
            gameState.target.angle = Math.PI - gameState.target.angle;
          }
          if (gameState.target.y - gameState.target.radius < 0 ||
            gameState.target.y + gameState.target.radius > canvas.height) {
            gameState.target.angle = -gameState.target.angle;
          }
        }

        // Draw target with simple circle
        ctx.beginPath();
        ctx.arc(
          gameState.target.x,
          gameState.target.y,
          gameState.target.radius,
          0,
          Math.PI * 2
        );
        ctx.fillStyle = '#212529';
        ctx.fill();
      }

      // Continue animation loop if playing
      if (gameState.isPlaying) {
        requestAnimationFrame(drawGame);
      }
    }

    // Start the game
    function startGame() {
      // Reset game state
      gameState.score = 0;
      gameState.isPlaying = true;
      gameState.reactionTimes = [];
      scoreDisplay.textContent = '0';

      // Start game loop
      spawnTarget();
      drawGame();
    }

    // Game over
    function gameOver() {
      gameState.isPlaying = false;
      gameState.target = null;

      // Calculate average reaction time
      let avgReaction = 0;
      if (gameState.reactionTimes.length > 0) {
        avgReaction = Math.round(
          gameState.reactionTimes.reduce((a, b) => a + b, 0) /
          gameState.reactionTimes.length
        );
      }

      // Show game over screen
      finalScoreDisplay.textContent = `Score: ${gameState.score}`;
      reactionTimeDisplay.textContent = `Average Reaction: ${avgReaction}ms`;
      gameOverScreen.style.display = 'flex';
    }

    // Initialize the game when loaded
    window.addEventListener('load', initGame);
  </script>
</body>

</html>